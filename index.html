<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>TokatlÄ±yoruz!</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      --bg:#f6f8fb; --text:#1f2937; --muted:#6b7280;
      --accent:#ef4444; --accent-2:#f97316;
    }
    *{box-sizing:border-box}
    body{
      margin:0; padding:32px 14px; min-height:100vh;
      display:flex; align-items:flex-start; justify-content:center;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      font-size:16px; color:var(--text); background:var(--bg);
    }
    .wrap{ width:min(900px,100%); text-align:center; }

    h1{ margin:0 0 18px; font-size:clamp(20px,4.4vw,32px) }

    .stats{
      display:grid; gap:8px; margin:14px auto 18px;
      color:var(--muted); font-size:clamp(13px,2.8vw,17px)
    }
    .stats b{ color:var(--text) }

    /* GÃ¶rsel ve video â€“ yan yana, taÅŸma yok; boÅŸluk sÄ±fÄ±r */
    .avatar-wrap{
      display:flex; align-items:center; justify-content:center; flex-wrap:nowrap;
      gap:0; margin:10px auto 16px; background:#fff;
      padding:10px 0; border-radius:16px;
      box-shadow:0 6px 18px rgba(0,0,0,.08); overflow:hidden;
      /* En fazla geniÅŸlik: iki eleman yanyana sÄ±ÄŸsÄ±n */
      max-width: 100%;
    }

    /* Boyutlar ekrana gÃ¶re akÄ±cÄ± kÃ¼Ã§Ã¼lÃ¼r */
    #target{
      width:clamp(140px, 28vw, 260px);
      height:auto; display:block; margin:0; border-radius:0;
      transition:transform .08s ease;
    }
    #slapVideo{
      width:clamp(110px, 22vw, 200px);
      height:auto; display:block; margin:0; border-radius:0;
      box-shadow:none; opacity:0; transform:translateX(35%);
      transition:opacity .2s ease, transform .25s ease;
    }
    #slapVideo.show{ opacity:1; transform:translateX(0) }

    .shake{ animation:shake .18s linear 1 }
    @keyframes shake{
      0%{transform:translateX(0)}
      25%{transform:translateX(-12px) rotate(-2deg)}
      50%{transform:translateX(9px) rotate(2deg)}
      75%{transform:translateX(-6px) rotate(-1deg)}
      100%{transform:translateX(0)}
    }

    .btn{
      appearance:none; border:0; cursor:pointer;
      padding:clamp(12px,2.8vw,16px) clamp(18px,4.2vw,24px);
      border-radius:999px; font-weight:700;
      font-size:clamp(14px,3.8vw,18px); color:#fff;
      background:linear-gradient(135deg,var(--accent),var(--accent-2));
      box-shadow:0 8px 18px rgba(239,68,68,.30);
      transition:transform .06s ease, box-shadow .2s ease, filter .2s ease;
    }
    .btn:hover{ filter:brightness(1.05) }
    .btn:active{ transform:translateY(1px) scale(.98); box-shadow:0 5px 12px rgba(239,68,68,.30) }

    .count-big{ font-size:clamp(28px,10vw,56px); font-weight:800; margin:12px 0 0 }
    .record{ margin-top:8px; color:#111; font-weight:700; font-size:clamp(16px,4.6vw,22px) }
    .note{ margin-top:14px; color:var(--muted); font-size:clamp(12px,3.8vw,16px) }
    footer{ margin-top:28px; font-size:clamp(16px,4.8vw,22px); font-weight:bold; color:var(--accent) }

    /* KÃ¼Ã§Ã¼k ekran iyileÅŸtirmeleri (yan yana kalsÄ±n ama daha da kÃ¼Ã§Ã¼lsÃ¼n) */
    @media (max-width: 420px){
      .avatar-wrap{ padding:6px 0 }
      #target{ width:clamp(120px, 40vw, 200px) }
      #slapVideo{ width:clamp(90px, 30vw, 160px) }
    }
  </style>
</head>
<body>
  <main class="wrap">
    <h1>Keremi TokatlÄ±yoruz.</h1>

    <div class="stats" id="stats"></div>

    <div class="avatar-wrap">
      <img id="target" src="./selfie_drawing_style.png" alt="KarikatÃ¼r Surat">
      <video id="slapVideo" preload="auto" playsinline muted>
        <source src="./video.mp4" type="video/mp4">
      </video>
    </div>

    <div><button id="slapBtn" class="btn">Tokatla ðŸ˜¡</button></div>

    <div class="count-big" id="sessionCount">0</div>
    <div class="record" id="recordText">Tokat rekorun: 0</div>
    <div class="note">SayaÃ§lar tarayÄ±cÄ±nda saklanÄ±r (cihaza Ã¶zeldir).</div>

    <footer>GidiÅŸine illa bir isim konulacaksa MAL KAYBI diyelim.</footer>
  </main>

  <script>
    // SayaÃ§lar
    const LS_TOTAL="slap_total", LS_RECORD="slap_record", LS_BASE="slap_base_seed";
    let base=+localStorage.getItem(LS_BASE);
    if(!base){ base=Math.floor(50000000+Math.random()*30000000); localStorage.setItem(LS_BASE,base); }
    let total=+localStorage.getItem(LS_TOTAL)||0;
    let record=+localStorage.getItem(LS_RECORD)||0;
    let session=0;

    const statsEl=document.getElementById("stats");
    const targetImg=document.getElementById("target");
    const video=document.getElementById("slapVideo");
    const sessionCountEl=document.getElementById("sessionCount");
    const recordTextEl=document.getElementById("recordText");
    const btn=document.getElementById("slapBtn");

    function format(n){ return n.toLocaleString("tr-TR"); }
    function renderStats(){
      statsEl.innerHTML = `
        <div>BugÃ¼ne kadar <b>${format(base+total)}</b> kere tokatlandÄ±!</div>
        <div>Åžu an <b>${format(session)}</b> kere tokatladÄ±n!</div>`;
      sessionCountEl.textContent=format(session);
      recordTextEl.textContent="Tokat rekorun: "+format(record);
    }

    video.addEventListener("ended",()=>video.classList.remove("show"));

    function slap(){
      targetImg.classList.remove("shake");
      requestAnimationFrame(()=>targetImg.classList.add("shake"));
      setTimeout(()=>targetImg.classList.remove("shake"),400);

      try{
        video.pause(); video.currentTime=0; video.classList.add("show");
        video.play().catch(()=>{ video.muted=true; video.play().catch(()=>{}); });
      }catch(e){}

      session++; total++;
      if(session>record){ record=session; localStorage.setItem(LS_RECORD,record); }
      localStorage.setItem(LS_TOTAL,total);
      renderStats();
    }

    renderStats();
    btn.addEventListener("click", slap);
  </script>
</body>
</html>
